<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Menu Pemesanan</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f4f4f4; }
    .item, li { background: #fff; padding: 10px; margin: 10px 0; border-radius: 5px; box-shadow: 0 0 5px #ccc; }
    button { margin-top: 5px; padding: 6px 12px; border: none; border-radius: 5px; cursor: pointer; }
    .hapus-btn { background: #e74c3c; color: white; margin-left: 10px; }
    .pesan-btn { background: #3498db; color: white; }
  </style>
</head>
<body>

<h2>Menu Makanan</h2>
<div class="menu">
  <div class="item">
    <strong>Nasi Goreng</strong><br>Rp25.000<br>
    <button class="pesan-btn" onclick="tambah('Nasi Goreng', 25000)">Pesan</button>
  </div>
  <div class="item">
    <strong>Mie Ayam</strong><br>Rp22.000<br>
    <button class="pesan-btn" onclick="tambah('Mie Ayam', 22000)">Pesan</button>
  </div>
</div>

<h2>Daftar Pesanan</h2>
<ul id="daftar"></ul>
<p>Total: Rp<span id="total">0</span></p>
<button onclick="kirimPesanan()">Kirim ke Google Sheet</button>

<script>
  const daftar = [];
  const listEl = document.getElementById("daftar");
  const totalEl = document.getElementById("total");

  function tambah(menu, harga) {
    daftar.push({ menu, harga });
    render();
  }

  function hapus(i) {
    daftar.splice(i, 1);
    render();
  }

  function render() {
    listEl.innerHTML = "";
    let total = 0;
    daftar.forEach((item, i) => {
      total += item.harga;
      const li = document.createElement("li");
      li.innerHTML = `${item.menu} - Rp${item.harga.toLocaleString()}
        <button class="hapus-btn" onclick="hapus(${i})">Hapus</button>`;
      listEl.appendChild(li);
    });
    totalEl.textContent = total.toLocaleString();
  }

  function kirimPesanan() {
    if (daftar.length === 0) {
      alert("Belum ada pesanan!");
      return;
    }

    fetch("https://script.google.com/macros/s/AKfycbymI5XVfPZ7aRDoA4cyjuxS3txgkiue9XiiAexsfCSG/dev", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(daftar)
    })
    .then(res => res.json())
    .then(res => {
      if (res.status === "success") {
        alert("Pesanan berhasil dikirim!");
        daftar.length = 0;
        render();
      } else {
        alert("Gagal: " + res.message);
      }
    })
    .catch(err => {
      alert("Gagal mengirim: " + err.message);
      console.error("Error:", err);
    });
  }
</script>

</body>
</html>
